<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Operasi Vektor Secara Grafis</title>
<style>
:root {
  /* ---- Light Mode (Physics Lab) ---- */
  --bg:#f4f9ff;
  --card:#ffffff;
  --ink:#1e293b;
  --muted:#475569;
  --accent:#3b82f6;
  --red:#ef4444;
  --green:#22c55e;
  --blue:#2563eb;
  --dash:#94a3b8;
  --grid:#cbd5e1;
  --border:#e2e8f0;
}

/* ---- Dark Mode ---- */
[data-theme="dark"] {
  --bg:#0f172a;
  --card:#0b1220;
  --ink:#e5e7eb;
  --muted:#94a3b8;
  --accent:#22d3ee;
  --red:#ef4444;
  --green:#22c55e;
  --blue:#3b82f6;
  --dash:#64748b;
  --grid:#1f2937;
  --border:#1f2937;
}

*{box-sizing:border-box}
body{
  margin:0;
  font:16px/1.5 system-ui,Segoe UI,Roboto,Helvetica,Arial;
  background:var(--bg);
  color:var(--ink);
  transition:background .3s,color .3s;
}
header{
  text-align:center;
  padding:24px 16px 16px;
  border-bottom:1px solid var(--border);
  position:relative;
  background:var(--card);
  transition:background .3s;
}
h1{margin:.3rem 0;font-weight:800;font-size:1.8rem;color:var(--ink);}
.sub{color:var(--muted);font-size:1rem;}
#themeToggle{
  position:absolute;top:18px;right:18px;
  border:none;border-radius:50%;
  width:40px;height:40px;
  background:var(--accent);color:#fff;
  font-size:1.1rem;cursor:pointer;
  transition:background .3s,transform .2s;
}
#themeToggle:hover{transform:scale(1.05);}
.wrap{max-width:1100px;margin:24px auto;padding:0 16px;}
.tabs{display:flex;gap:8px;flex-wrap:wrap;}
.tab{padding:10px 14px;border:1px solid var(--border);border-radius:10px;background:var(--card);
     color:var(--muted);cursor:pointer;transition:all .3s;}
.tab.active{color:#fff;background:var(--accent);border-color:transparent;font-weight:700;}
.grid{display:grid;grid-template-columns:380px 1fr;gap:18px;margin-top:16px;}
.card{background:var(--card);border:1px solid var(--border);border-radius:14px;padding:16px;transition:background .3s,border .3s;}
h2{margin:.2rem 0 .6rem;font-size:1.1rem;}
details{border:1px dashed var(--border);border-radius:10px;padding:10px;margin:8px 0;background:var(--bg);}
label{display:block;margin:.3rem 0;color:var(--muted);font-size:.92rem;}
input{width:100%;padding:10px;border-radius:10px;border:1px solid var(--border);
       background:var(--bg);color:var(--ink);}
.row{display:grid;grid-template-columns:1fr 1fr;gap:10px;}
canvas{width:100%;height:520px;background:var(--bg);border:1px solid var(--border);border-radius:14px;}
.btns{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px;}
button{padding:10px 12px;border-radius:10px;border:1px solid var(--border);
        background:var(--card);color:var(--ink);cursor:pointer;transition:background .2s;}
button.primary{background:var(--accent);color:#fff;border:0;font-weight:700;}
.kpi{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin-top:8px;}
.chip{background:var(--bg);border:1px solid var(--border);border-radius:12px;padding:10px;text-align:center;}
code{background:var(--bg);border:1px solid var(--border);padding:2px 6px;border-radius:6px;}
footer{opacity:.7;text-align:center;padding:24px 8px;color:var(--muted);}
@media(max-width:980px){.grid{grid-template-columns:1fr}}
</style>
</head>
<body>

<header>
  <button id="themeToggle">🌙</button>
  <h1>Operasi Vektor Secara Grafis</h1>
  <div class="sub">Metode Poligon dan Metode Jajargenjang</div>
</header>

<div class="wrap">
  <div class="tabs" id="tabs">
    <button class="tab active" data-tab="poly">Metode Poligon</button>
    <button class="tab" data-tab="para">Metode Jajargenjang</button>
  </div>

  <!-- === POLIGON === -->
  <section id="poly" class="grid">
    <div class="card">
      <h2>Orientasi Masalah</h2>
      <details open>
        <summary><strong>Kasus:</strong> Resultan Perpindahan Tiga Lintasan</summary>
        <p class="muted">Sebuah robot bergerak pada bidang datar: pertama maju, lalu serong, dan terakhir turun.
        Tentukan arah dan besar <em>perpindahan total</em> secara grafis dengan menyusun vektor
        <b>ujung ke pangkal</b>.</p>
      </details>
      <h2>Input Vektor</h2>
      <div class="row">
        <div><label>A – besar</label><input id="pa" type="number" step="0.1" value="4"></div>
        <div><label>A – sudut (°)</label><input id="ta" type="number" step="1" value="0"></div>
      </div>
      <div class="row">
        <div><label>B – besar</label><input id="pb" type="number" step="0.1" value="3"></div>
        <div><label>B – sudut (°)</label><input id="tb" type="number" step="1" value="-45"></div>
      </div>
      <div class="row">
        <div><label>C – besar</label><input id="pc" type="number" step="0.1" value="2"></div>
        <div><label>C – sudut (°)</label><input id="tc" type="number" step="1" value="-90"></div>
      </div>
      <div class="btns">
        <button class="primary" id="draw-poly">Gambar & Hitung</button>
        <button id="reset-poly">Reset</button>
      </div>
      <div class="kpi">
        <div class="chip"><div class="muted">R<sub>x</sub></div><div id="rxp">–</div></div>
        <div class="chip"><div class="muted">R<sub>y</sub></div><div id="ryp">–</div></div>
        <div class="chip"><div class="muted">|R|</div><div id="rmp">–</div></div>
        <div class="chip"><div class="muted">θ (°)</div><div id="rtp">–</div></div>
      </div>
    </div>
    <div class="card">
      <h2>Gambar – Metode Poligon</h2>
      <canvas id="canvas-poly" width="800" height="520"></canvas>
    </div>
  </section>

  <!-- === JAJARGENJANG === -->
  <section id="para" class="grid" style="display:none">
    <div class="card">
      <h2>Orientasi Masalah</h2>
      <details open>
        <summary><strong>Kasus:</strong> Dua Gaya Menarik Benda dari Satu Titik</summary>
        <p class="muted">Sebuah kotak ditarik dua tali: satu ke arah timur-laut dan satu lagi ke arah timur-tenggara.
        Tentukan resultan gaya secara grafis dengan <b>metode jajargenjang</b>.</p>
      </details>
      <h2>Input Vektor</h2>
      <div class="row">
        <div><label>A – besar</label><input id="qa" type="number" step="0.1" value="5"></div>
        <div><label>A – sudut (°)</label><input id="ua" type="number" step="1" value="45"></div>
      </div>
      <div class="row">
        <div><label>B – besar</label><input id="qb" type="number" step="0.1" value="5"></div>
        <div><label>B – sudut (°)</label><input id="ub" type="number" step="1" value="-30"></div>
      </div>
      <div class="btns">
        <button class="primary" id="draw-para">Gambar & Hitung</button>
        <button id="reset-para">Reset</button>
      </div>
      <div class="kpi">
        <div class="chip"><div class="muted">R<sub>x</sub></div><div id="rxq">–</div></div>
        <div class="chip"><div class="muted">R<sub>y</sub></div><div id="ryq">–</div></div>
        <div class="chip"><div class="muted">|R|</div><div id="rmq">–</div></div>
        <div class="chip"><div class="muted">θ (°)</div><div id="rtq">–</div></div>
      </div>
    </div>
    <div class="card">
      <h2>Gambar – Metode Jajargenjang</h2>
      <canvas id="canvas-para" width="800" height="520"></canvas>
    </div>
  </section>

  <footer>© LKPD Interaktif – Operasi Vektor Grafis</footer>
</div>

<script>
/* ========= Tema Toggle ========= */
const body=document.body;
const btn=document.getElementById("themeToggle");
function setTheme(mode){
  if(mode==="dark"){body.dataset.theme="dark";btn.textContent="☀️";}
  else{body.dataset.theme="light";btn.textContent="🌙";}
  localStorage.setItem("theme",mode);
}
setTheme(localStorage.getItem("theme")||"light");
btn.onclick=()=>setTheme(body.dataset.theme==="dark"?"light":"dark");

/* ========= Tabs ========= */
document.querySelectorAll('#tabs .tab').forEach(b=>{
  b.addEventListener('click',()=>{
    document.querySelectorAll('#tabs .tab').forEach(x=>x.classList.remove('active'));
    b.classList.add('active');
    const tab=b.dataset.tab;
    document.getElementById('poly').style.display=tab==='poly'?'grid':'none';
    document.getElementById('para').style.display=tab==='para'?'grid':'none';
  });
});

/* ========= Math & Draw ========= */
const toRad=d=>d*Math.PI/180, round=(x,n=2)=>Number(x.toFixed(n));
function comp(mag,deg){const th=toRad(deg);return{x:mag*Math.cos(th),y:mag*Math.sin(th)};}
function sumVec(a){return a.reduce((s,v)=>({x:s.x+v.x,y:s.y+v.y}),{x:0,y:0});}
function mag(v){return Math.hypot(v.x,v.y);}
function ang(v){return (Math.atan2(v.y,v.x)*180/Math.PI);}
function makeDraw(ctx,w,h){
  const cx=w/2,cy=h/2,scale=30;
  ctx.clearRect(0,0,w,h);
  ctx.strokeStyle=getComputedStyle(document.body).getPropertyValue('--grid').trim();ctx.lineWidth=1;
  for(let x=0;x<w;x+=30){ctx.beginPath();ctx.moveTo(x,0);ctx.lineTo(x,h);ctx.stroke();}
  for(let y=0;y<h;y+=30){ctx.beginPath();ctx.moveTo(0,y);ctx.lineTo(w,y);ctx.stroke();}
  ctx.strokeStyle=getComputedStyle(document.body).getPropertyValue('--dash').trim();ctx.lineWidth=1.5;
  ctx.beginPath();ctx.moveTo(0,cy);ctx.lineTo(w,cy);ctx.stroke();
  ctx.beginPath();ctx.moveTo(cx,0);ctx.lineTo(cx,h);ctx.stroke();
  function drawArrow(x1,y1,x2,y2,color,th=3){
    ctx.strokeStyle=color;ctx.lineWidth=th;
    ctx.beginPath();ctx.moveTo(x1,y1);ctx.lineTo(x2,y2);ctx.stroke();
    const a=Math.atan2(y2-y1,x2-x1),ah=10,aw=6;
    ctx.beginPath();ctx.moveTo(x2,y2);
    ctx.lineTo(x2-ah*Math.cos(a)-aw*Math.sin(a),y2-ah*Math.sin(a)+aw*Math.cos(a));
    ctx.lineTo(x2-ah*Math.cos(a)+aw*Math.sin(a),y2-ah*Math.sin(a)-aw*Math.cos(a));
    ctx.closePath();ctx.fillStyle=color;ctx.fill();
  }
  const pt=(px,py)=>({X:cx+px*scale,Y:cy-py*scale});
  return{pt,drawArrow};
}

/* ========= Polygon ========= */
function drawPolygon(){
  const A=+pa.value,B=+pb.value,C=+pc.value,a=+ta.value,b=+tb.value,c=+tc.value;
  const va=comp(A,a),vb=comp(B,b),vc=comp(C,c),R=sumVec([va,vb,vc]);
  const ctx=canvasPoly.getContext('2d');const d=makeDraw(ctx,800,520);
  const O=d.pt(0,0),Aend=d.pt(va.x,va.y),Bend=d.pt(va.x+vb.x,va.y+vb.y),Cend=d.pt(R.x,R.y);
  d.drawArrow(O.X,O.Y,Aend.X,Aend.Y,getComputedStyle(document.body).getPropertyValue('--red').trim());
  d.drawArrow(Aend.X,Aend.Y,Bend.X,Bend.Y,getComputedStyle(document.body).getPropertyValue('--blue').trim());
  d.drawArrow(Bend.X,Bend.Y,Cend.X,Cend.Y,getComputedStyle(document.body).getPropertyValue('--green').trim());
  ctx.setLineDash([8,6]);d.drawArrow(O.X,O.Y,Cend.X,Cend.Y,getComputedStyle(document.body).getPropertyValue('--dash').trim());ctx.setLineDash([]);
  rxp.textContent=round(R.x);ryp.textContent=round(R.y);rmp.textContent=round(mag(R));rtp.textContent=round(ang(R));
}
drawPoly.onclick=drawPolygon;
resetPoly.onclick=()=>{['pa','pb','pc','ta','tb','tc'].forEach(i=>window[i].value='');makeDraw(canvasPoly.getContext('2d'),800,520);
['rxp','ryp','rmp','rtp'].forEach(i=>window[i].textContent='–');};

/* ========= Parallelogram ========= */
function drawParallelogram(){
  const A=+qa.value,B=+qb.value,a=+ua.value,b=+ub.value;
  const va=comp(A,a),vb=comp(B,b),R=sumVec([va,vb]);
  const ctx=canvasPara.getContext('2d');const d=makeDraw(ctx,800,520);
  const O=d.pt(0,0),Aend=d.pt(va.x,va.y),Bend=d.pt(vb.x,vb.y),Rend=d.pt(R.x,R.y);
  d.drawArrow(O.X,O.Y,Aend.X,Aend.Y,getComputedStyle(document.body).getPropertyValue('--red').trim());
  d.drawArrow(O.X,O.Y,Bend.X,Bend.Y,getComputedStyle(document.body).getPropertyValue('--blue').trim());
  ctx.setLineDash([6,6]);ctx.strokeStyle=getComputedStyle(document.body).getPropertyValue('--dash').trim();ctx.lineWidth=2;
  ctx.beginPath();ctx.moveTo(Aend.X,Aend.Y);ctx.lineTo(Aend.X+(Bend.X-O.X),Aend.Y+(Bend.Y-O.Y));ctx.stroke();
  ctx.beginPath();ctx.moveTo(Bend.X,Bend.Y);ctx.lineTo(Bend.X+(Aend.X-O.X),Bend.Y+(Aend.Y-O.Y));ctx.stroke();ctx.setLineDash([]);
  d.drawArrow(O.X,O.Y,Rend.X,Rend.Y,getComputedStyle(document.body).getPropertyValue('--accent').trim());
  rxq.textContent=round(R.x);ryq.textContent=round(R.y);rmq.textContent=round(mag(R));rtq.textContent=round(ang(R));
}
drawPara.onclick=drawParallelogram;
resetPara.onclick=()=>{['qa','qb','ua','ub'].forEach(i=>window[i].value='');makeDraw(canvasPara.getContext('2d'),800,520);
['rxq','ryq','rmq','rtq'].forEach(i=>window[i].textContent='–');};

/* initial draw */
const canvasPoly=document.getElementById('canvas-poly');
const canvas
